<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<body>

<!-- Enhanced Stat Card Fragment -->
<div th:fragment="stat-card(title, value, icon, color, subtitle)" class="col-md-3 mb-4">
    <div class="card stat-card-enhanced" th:style="'--card-color: ' + ${color} + ';'">
        <div class="card-body">
            <div class="stat-icon" th:style="'background: linear-gradient(135deg, ' + ${color} + ' 0%, ' + ${color} + 'dd 100%);'">
                <i th:class="${icon}"></i>
            </div>
            <div class="stat-value" th:text="${value}">Value</div>
            <div class="stat-label" th:text="${title}">Title</div>
            <div class="stat-description" th:if="${subtitle}" th:text="${subtitle}">Subtitle</div>
        </div>
    </div>
</div>

<!-- Enhanced Transaction Card Fragment -->
<div th:fragment="transaction-card(transaction)" class="col-md-6 col-lg-4 mb-4">
    <div class="card transaction-card h-100" th:style="'--transaction-color: ' + (${transaction.category != null} ? ${transaction.category.colorCode} : '#6c757d') + ';'">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <h6 class="card-title fw-bold" th:text="${transaction.description}">Transaction</h6>
                <span th:class="'badge px-3 py-2 ' + (${transaction.transactionType == 'INCOME'} ? 'bg-success' : 'bg-danger')"
                      th:text="${transaction.transactionType}" style="border-radius: 20px;">Type</span>
            </div>
            <div class="d-flex align-items-center mb-3">
                <div class="me-3" th:style="'width: 12px; height: 12px; border-radius: 50%; background-color: ' + (${transaction.category != null} ? ${transaction.category.colorCode} : '#6c757d') + ';'"></div>
                <div>
                    <small class="text-muted">
                        <i class="bi bi-calendar me-1"></i> 
                        <span th:text="${#temporals.format(transaction.transactionDate, 'MMM dd, yyyy')}">Date</span>
                    </small>
                    <div th:if="${transaction.category != null}" class="mt-1">
                        <span class="badge px-2 py-1" th:style="'background-color: ' + ${transaction.category.colorCode} + '; color: white; border-radius: 15px; font-size: 0.7rem;'"
                              th:text="${transaction.category.name}">Category</span>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-between align-items-center">
                <span th:class="'fw-bold fs-5 ' + (${transaction.transactionType == 'INCOME'} ? 'text-success' : 'text-danger')"
                      th:text="(${transaction.transactionType == 'INCOME'} ? '+' : '-') + '$' + ${#numbers.formatDecimal(transaction.amount, 1, 2)}">Amount</span>
                <div class="btn-group btn-group-sm">
                    <a th:href="@{/transactions/{id}/edit(id=${transaction.id})}" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-pencil"></i>
                    </a>
                    <a th:href="@{/transactions/{id}/delete(id=${transaction.id})}" 
                       class="btn btn-outline-danger btn-sm"
                       onclick="return confirm('Are you sure you want to delete this transaction?')">
                        <i class="bi bi-trash"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Enhanced Category Card Fragment -->
<div th:fragment="category-card(category)" class="col-md-6 col-lg-4 mb-4">
    <div class="card category-card h-100" th:style="'--category-color: ' + (${category.colorCode ?: '#667eea'}) + ';'">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <h5 class="card-title d-flex align-items-center">
                    <span class="category-badge" th:style="'background-color: ' + (${category.colorCode ?: '#667eea'}) + ';'"></span>
                    <span th:text="${category.name}">Category</span>
                </h5>
                <span th:class="'status-badge ' + (${category.isActive} ? 'bg-success' : 'bg-secondary')"
                      th:text="${category.isActive ? 'Active' : 'Inactive'}">Status</span>
            </div>
            <p class="card-text text-muted" th:text="${category.description ?: 'No description'}">Description</p>
            <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">
                    <i class="bi bi-arrow-left-right me-1"></i> 
                    <span th:text="${category.transactionCount ?: 0}">0</span> transactions
                </small>
                <div class="btn-group btn-group-sm">
                    <a th:href="@{/categories/{id}/edit(id=${category.id})}" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-pencil"></i>
                    </a>
                    <a th:href="@{/categories/{id}/delete(id=${category.id})}" 
                       class="btn btn-outline-danger btn-sm"
                       onclick="return confirm('Are you sure you want to delete this category?')">
                        <i class="bi bi-trash"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Enhanced Budget Card Fragment -->
<div th:fragment="budget-card(budget)" class="col-md-6 col-lg-4 mb-4">
    <div class="card budget-card h-100" th:style="'--budget-color: ' + (${budget.overBudget} ? '#dc3545' : (${budget.utilizationPercentage > 80} ? '#ffc107' : '#28a745')) + ';'">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <h5 class="card-title fw-bold" th:text="${budget.name}">Budget</h5>
                <span th:class="'status-badge ' + (${budget.isActive} ? 'bg-success' : 'bg-secondary')"
                      th:text="${budget.isActive ? 'Active' : 'Inactive'}">Status</span>
            </div>
            
            <p class="card-text text-muted" th:text="${budget.description ?: 'No description'}">Description</p>
            
            <div class="mb-3">
                <div class="d-flex justify-content-between mb-2">
                    <small class="fw-bold">Progress</small>
                    <small th:class="'fw-bold ' + (${budget.overBudget} ? 'text-danger' : (${budget.utilizationPercentage > 80} ? 'text-warning' : 'text-success'))"
                           th:text="${budget.utilizationPercentage ?: 0} + '%'">0%</small>
                </div>
                <div class="progress" style="height: 8px; border-radius: 10px;">
                    <div th:class="'progress-bar-custom'"
                         th:style="'width: ' + ${budget.utilizationPercentage ?: 0} + '%; background: linear-gradient(90deg, ' + (${budget.overBudget} ? '#dc3545 0%, #fd7e14 100%' : (${budget.utilizationPercentage > 80} ? '#ffc107 0%, #fd7e14 100%' : '#28a745 0%, #20c997 100%')) + ');'"></div>
                </div>
            </div>
            
            <div class="row text-center mb-3">
                <div class="col-6">
                    <small class="text-muted">Budget</small>
                    <div class="fw-bold text-primary" th:text="'$' + ${#numbers.formatDecimal(budget.budgetAmount, 1, 2)}">$0.00</div>
                </div>
                <div class="col-6">
                    <small class="text-muted">Spent</small>
                    <div th:class="'fw-bold ' + (${budget.overBudget} ? 'text-danger' : 'text-success')"
                         th:text="'$' + ${#numbers.formatDecimal(budget.spentAmount ?: 0, 1, 2)}">$0.00</div>
                </div>
            </div>
            
            <div class="d-flex justify-content-between align-items-center">
                <small class="text-muted">
                    <i class="bi bi-calendar me-1"></i> 
                    <span th:text="${#temporals.format(budget.startDate, 'MMM dd')} + ' - ' + ${#temporals.format(budget.endDate, 'MMM dd')}">Date Range</span>
                </small>
                <div class="btn-group btn-group-sm">
                    <a th:href="@{/budgets/{id}/edit(id=${budget.id})}" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-pencil"></i>
                    </a>
                    <a th:href="@{/budgets/{id}/delete(id=${budget.id})}" 
                       class="btn btn-outline-danger btn-sm"
                       onclick="return confirm('Are you sure you want to delete this budget?')">
                        <i class="bi bi-trash"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

</body>
</html>
